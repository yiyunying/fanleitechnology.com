const compare_nonce=gscomparevars.comparenonce;function getLinksToCompareOnPage(){let e=document.querySelectorAll(".gs-comparison-icon-link-to-compare"),t="";for(let r=0;r<e.length;r++)t+=r+"--"+e[r].getAttribute("data-clear-link")+";";return t}function setNewUrlToLinksOnComparePage(e){let t=document.querySelectorAll(".gs-comparison-icon-link-to-compare");for(let r=0;r<t.length;r++)t[r].setAttribute("href",e[r]);return e}document.addEventListener("click",function(e){if(!e.target.closest(".gscompareplus"))return!1;{let t=e.target.closest(".gscompareplus");e.preventDefault();let r="add";if(t.classList.contains("restrict_for_guests")){let o=t.dataset.customurl;return window.location.href=o,!1}if(t.classList.contains("alreadycompare")){if(void 0!==t.dataset.comparelink&&""!=t.dataset.comparelink&&null==document.querySelector(".gspb-favorites-posts"))return window.location.href=t.dataset.comparelink,!1;r="remove"}let n=parseInt(t.dataset.post_id),a=parseInt(t.dataset.informer),s=t.querySelector(".compareiconwrap").innerHTML;t.classList.add("loading"),t.querySelector(".compareiconwrap").innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="20" viewBox="0 0 100 100"><path d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50"><animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="0 50 50" to="360 50 50" repeatCount="indefinite"></animateTransform></path></svg>';let c=new XMLHttpRequest;c.open("POST",gscomparevars.ajax_url,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),c.responseType="json",c.onload=function(){if(this.status>=200&&this.status<400){let e=this.response;(e.links.length&&setNewUrlToLinksOnComparePage(e.links),t.querySelector(".compareiconwrap").innerHTML=s,t.classList.remove("loading"),"remove"==r)?(t.classList.remove("alreadycompare"),a-=1,t.closest(".gs-comparison-wrap").querySelector("#comparecount"+n).innerHTML=a,null!=document.querySelector(".gs-compare-icon-counter")&&document.querySelectorAll(".gs-compare-icon-counter").forEach(function(e){let t=parseInt(e.innerHTML);e.innerHTML=t-1}),t.dataset.informer=a):(t.classList.add("alreadycompare"),a+=1,t.closest(".gs-comparison-wrap").querySelector("#comparecount"+n).innerHTML=a,null!=document.querySelector(".gs-compare-icon-counter")&&document.querySelectorAll(".gs-compare-icon-counter").forEach(function(e){let t=parseInt(e.innerHTML);e.innerHTML=t+1}),t.dataset.informer=a)}},c.onerror=function(){};let i=getLinksToCompareOnPage();c.send("action=gscomparecounter&comparenonce="+compare_nonce+"&compare_count="+r+"&post_id="+n+"&links="+i)}});const requestCompareUpdate=new XMLHttpRequest;requestCompareUpdate.open("POST",gscomparevars.ajax_url,!0),requestCompareUpdate.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),requestCompareUpdate.responseType="json",requestCompareUpdate.onload=function(){if(this.status>=200&&this.status<400){let e=this.response;if(e.comparisonids){let t=e.comparisonids.split(",");0!=t.length&&(document.querySelectorAll(".gscompareplus").forEach(function(e){var r=e.getAttribute("data-post_id");if(t.includes(r)&&!e.classList.contains("alreadycompare")){e.classList.add("alreadycompare");let o=parseInt(e.getAttribute("data-informer"));o+=1,e.setAttribute("data-informer",o),e.closest(".gs-comparison-wrap").querySelector("#comparecount"+r).innerHTML=o}}),null!=document.querySelector(".gs-compare-icon-counter")&&document.querySelectorAll(".gs-compare-icon-counter").forEach(function(t){t.innerHTML=e.comparecounter}))}}},requestCompareUpdate.onerror=function(){},requestCompareUpdate.send("action=gscomparerecount&comparenonce="+compare_nonce);